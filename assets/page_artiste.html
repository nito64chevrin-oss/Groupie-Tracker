<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/statics/style.css">
    <link rel="shortcut icon" type="image/png" href="/statics/image/logo_min.png"/>
    <title>{{.Artist.Nom}} - Groupi Music</title>
</head>
<body>
    <header>
        <div class="logo-wrap" data-title="Groupi Music">
            <a href="/"><img class="logo" src="/statics/image/logo-v2.png" alt="logo site"></a>
            <h1 class="site-title">Groupi Music</h1>
        </div>
        
        <form class="search-container" method="GET" action="/">
            <input type="text" name="search" id="searchBox" class="search-box" placeholder="Rechercher un artiste ou un membre..." autocomplete="off">
            <button type="submit" class="search-button">Rechercher</button>
        </form>
        
        <a href="/" class="back-link">Retour</a>
    </header>

    <main class="artist-page-main">
        <div class="content-wrapper">
            <div class="artist-container">
            <!-- Hero Section avec Background -->
            <div class="artist-hero">
                <div class="hero-background"></div>
                <div class="hero-content">
                    <img src="{{.Artist.Image}}" alt="{{.Artist.Nom}}" class="hero-image">
                    <div class="hero-info">
                        <h1 class="hero-title">{{.Artist.Nom}}</h1>
                        <p class="hero-meta">Artiste | {{len .Artist.Membres}} membres</p>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-label">Créé en:</span>
                        <span class="stat-value">{{.Artist.DateCreation}}</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-label">Album:</span>
                        <span class="stat-value">{{.Artist.FirstAlbum}}</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-label">Concerts:</span>
                        <span class="stat-value">{{len .Relations.DatesLocations}}</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon"></div>
                    <div class="stat-content">
                        <span class="stat-label">Lieux:</span>
                        <span class="stat-value">{{len .Locations.Locations}}</span>
                    </div>
                </div>
            </div>

            <!-- Membres Section -->
            <section class="artist-section featured-section">
                <div class="section-header">
                    <h2>Membres</h2>
                    <div class="section-underline"></div>
                </div>
                <div class="members-grid">
                    {{range .Artist.Membres}}
                    <div class="member-item">
                        <div class="member-avatar">
                            {{. | getInitials}}
                        </div>
                        <p class="member-name">{{.}}</p>
                    </div>
                    {{end}}
                </div>
            </section>

            <!-- Discographie Section -->
            <section class="artist-section featured-section">
                <div class="section-header">
                    <h2>Discographie</h2>
                    <div class="section-underline"></div>
                </div>
                <div class="discography-grid">
                    <div class="album-card">
                        <div class="album-cover">
                            <img src="{{.Artist.Image}}" alt="{{.Artist.FirstAlbum}}">
                            <div class="album-overlay">
                                <p class="album-play">▶️</p>
                            </div>
                        </div>
                        <div class="album-info">
                            <h3>{{.Artist.FirstAlbum}}</h3>
                            <p class="album-artist">{{.Artist.Nom}}</p>
                            <p class="album-year">{{sliceYear .Artist.FirstAlbum}}</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Lieux de Tournée -->
            <section class="artist-section">
                <div class="section-header">
                    <h2>Lieux de Tournée</h2>
                    <div class="section-underline"></div>
                </div>
                <div class="locations-cloud">
                    {{range .Locations.Locations}}
                    <a href="{{. | googleMapsLink}}" target="_blank" class="location-chip location-link">
                        {{. | formatLocation}}
                    </a>
                    {{end}}
                </div>
            </section>

            <!-- Calendrier des Concerts -->
            <section class="artist-section">
                <div class="section-header">
                    <h2>Dates de Concerts</h2>
                    <div class="section-underline"></div>
                </div>
                <div class="concerts-timeline">
                    {{$relMap := .Relations.DatesLocations}}
                    {{range $location, $dates := $relMap}}
                    <div class="timeline-item">
                        <div class="timeline-marker">
                            <div class="timeline-dot"></div>
                        </div>
                        <div class="timeline-content">
                            <h4 class="concert-date-title">
                                <a href="{{$location | googleMapsLink}}" target="_blank" class="venue-title-link">
                                    {{$location | formatLocation}}
                                </a>
                            </h4>
                            <div class="concert-venues">
                                {{range $dates}}
                                <span class="venue-badge">{{. | formatDate}}</span>
                                {{end}}
                            </div>
                        </div>
                    </div>
                    {{end}}
                </div>
            </section>
        </div>
        </div>
    </main>

    <footer>
        <p>los locos</p>
    </footer>

    <script>
        // Animations au scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.artist-section, .quick-stats, .stat-item').forEach(el => {
            observer.observe(el);
        });

        // Tri des concerts par date
        const timelineItems = Array.from(document.querySelectorAll('.timeline-item'));
        const parentTimeline = document.querySelector('.concerts-timeline');
        
        if (timelineItems.length > 0 && parentTimeline) {
            timelineItems.sort((a, b) => {
                const dateA = a.querySelector('.concert-date-title').textContent.trim();
                const dateB = b.querySelector('.concert-date-title').textContent.trim();
                return new Date(dateA.split('/').reverse().join('-')) - new Date(dateB.split('/').reverse().join('-'));
            });
            
            parentTimeline.innerHTML = '';
            timelineItems.forEach(item => {
                parentTimeline.appendChild(item);
            });
        }
    </script>
</body>
</html>
